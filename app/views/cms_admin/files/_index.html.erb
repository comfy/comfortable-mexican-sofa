<% type ||= nil %>
<% files_scope = (type == 'image') ? @site.files.images : @site.files %>

<div class='box file_uploads'>
  
  <%= form_for :file, :url => cms_admin_site_files_path(@site), :html => {:multipart => true} do |form| %>
    <a id='uploader_button' href='#' class='big button'><%= t('.button') %></a>
    <%= form.file_field :file, :multiple => true, :id => false %>
  <% end %>
  
  <div class='uploaded_files'>
    <% cache('all_uploaded_files_' + @site.id.to_s) do %>
      <% files_scope.order(:label).each do |file| %>
        <%= render :partial => 'cms_admin/files/file', :object => file %>
      <% end %>
    <% end %>
  </div>
</div>
